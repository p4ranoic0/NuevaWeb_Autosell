<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autosell.pe - Compra tu Auto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }

        .nav-link {
            position: relative;
            transition: color 0.3s;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #3b82f6;
            transition: width 0.3s;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .vehicle-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            opacity: 0;
            /* Initial state for animation */
        }

        .vehicle-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Wishlist Heart Icon */
        .wishlist-btn .heart-icon,
        .share-btn .share-icon {
            transition: all 0.2s ease-in-out;
        }

        .wishlist-btn .heart-icon.filled {
            fill: #ef4444;
            stroke: #ef4444;
            transform: scale(1.1);
        }

        /* Compare Checkbox */
        .compare-checkbox {
            appearance: none;
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid #cbd5e1;
            border-radius: 0.25rem;
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s, border-color 0.2s;
        }

        .compare-checkbox:checked {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }

        .compare-checkbox:checked::after {
            content: '✔';
            font-size: 0.8rem;
            color: white;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* Price Range Slider */
        .price-slider-container {
            position: relative;
            height: 2rem;
        }

        .price-slider-track {
            position: absolute;
            height: 4px;
            background-color: #e2e8f0;
            width: 100%;
            top: 50%;
            transform: translateY(-50%);
            border-radius: 2px;
        }

        .price-slider-range {
            position: absolute;
            height: 4px;
            background-color: #3b82f6;
            top: 50%;
            transform: translateY(-50%);
            border-radius: 2px;
        }

        .price-slider-thumb {
            position: absolute;
            width: 1rem;
            height: 1rem;
            background-color: white;
            border: 2px solid #3b82f6;
            border-radius: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
            z-index: 10;
        }

        /* Share Popover */
        #share-popover {
            transform-origin: top right;
        }
    </style>
</head>

<body class="text-gray-800">

    <!-- Contenedor Principal -->
    <div class="w-full">

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-sm shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="/" class="text-2xl font-bold text-gray-900">
                Auto<span class="text-blue-600">sell</span>
            </a>
            <div class="hidden lg:flex items-center space-x-8">
                <a href="/comprar.html" class="nav-link text-blue-600 font-semibold border-b-2 border-blue-600">Comprar</a>
                <a href="/vender.html" class="nav-link text-gray-700 hover:text-blue-600 font-medium">Vender</a>
                <a href="/financiamiento.html"
                    class="nav-link text-gray-700 hover:text-blue-600 font-medium">Financiamiento</a>
                <a href="/nosotros.html" class="nav-link text-gray-700 hover:text-blue-600 font-medium">Sobre Nosotros</a>
                <a href="/blog.html" class="nav-link text-gray-700 hover:text-blue-600 font-medium">Blog</a>
            </div>
            <div class="hidden lg:flex items-center space-x-4">
                <a href="/contacto.html" class="text-gray-700 hover:text-blue-600 font-medium">Contacto</a>
                <a href="/login.html"
                    class="bg-blue-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors">Iniciar
                    Sesión</a>
            </div>
            <div class="lg:hidden">
                <button id="menu-btn" class="text-gray-700 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7">
                        </path>
                    </svg>
                </button>
            </div>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden lg:hidden px-6 pb-4">
            <a href="/comprar.html" class="block py-2 text-gray-700 hover:text-blue-600">Comprar</a>
            <a href="/vender.html" class="block py-2 text-gray-700 hover:text-blue-600">Vender</a>
            <a href="/financiamiento.html" class="block py-2 text-gray-700 hover:text-blue-600">Financiamiento</a>
            <a href="/nosotros.html" class="block py-2 text-gray-700 hover:text-blue-600">Sobre Nosotros</a>
            <a href="/blog.html" class="block py-2 text-gray-700 hover:text-blue-600">Blog</a>
            <a href="/contacto.html" class="block py-2 text-gray-700 hover:text-blue-600">Contacto</a>
            <a href="/login.html"
                class="block mt-2 bg-blue-600 text-white text-center font-semibold px-5 py-2 rounded-lg hover:bg-blue-700 transition-colors">Iniciar
                Sesión</a>
        </div>
    </header>

        <!-- Contenido de la página de compra -->
        <main class="container mx-auto px-6 py-8 md:py-12">
            <div class="text-center mb-10">
                <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900">Encuentra el Auto de tus Sueños</h1>
                <p class="text-lg text-gray-600 mt-2">Explora nuestro inventario de vehículos de alta gama,
                    inspeccionados y con garantía.</p>
            </div>

            <!-- Colecciones Curadas -->
            <div class="mb-12">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Explora por Estilo</h2>
                <div class="relative">
                    <div id="collections-container" class="flex overflow-x-auto space-x-4 pb-4 no-scrollbar">
                        <a href="#" class="flex-shrink-0 w-64 h-40 rounded-xl overflow-hidden relative group"><img
                                src="https://placehold.co/400x300/1e293b/ffffff?text=SUVs+Premium"
                                class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                                alt="[Imagen de SUVs Premium]">
                            <div class="absolute inset-0 bg-black/50 flex items-end p-4">
                                <h3 class="text-white text-xl font-bold">SUVs Premium</h3>
                            </div>
                        </a>
                        <a href="#" class="flex-shrink-0 w-64 h-40 rounded-xl overflow-hidden relative group"><img
                                src="https://placehold.co/400x300/334155/ffffff?text=Sedanes+de+Lujo"
                                class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                                alt="[Imagen de Sedanes de Lujo]">
                            <div class="absolute inset-0 bg-black/50 flex items-end p-4">
                                <h3 class="text-white text-xl font-bold">Sedanes de Lujo</h3>
                            </div>
                        </a>
                        <a href="#" class="flex-shrink-0 w-64 h-40 rounded-xl overflow-hidden relative group"><img
                                src="https://placehold.co/400x300/475569/ffffff?text=Deportivos"
                                class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                                alt="[Imagen de autos deportivos]">
                            <div class="absolute inset-0 bg-black/50 flex items-end p-4">
                                <h3 class="text-white text-xl font-bold">Deportivos</h3>
                            </div>
                        </a>
                        <a href="#" class="flex-shrink-0 w-64 h-40 rounded-xl overflow-hidden relative group"><img
                                src="https://placehold.co/400x300/0f172a/ffffff?text=Recién+Llegados"
                                class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                                alt="[Imagen de autos recién llegados]">
                            <div class="absolute inset-0 bg-black/50 flex items-end p-4">
                                <h3 class="text-white text-xl font-bold">Recién Llegados</h3>
                            </div>
                        </a>
                        <a href="#" class="flex-shrink-0 w-64 h-40 rounded-xl overflow-hidden relative group"><img
                                src="https://placehold.co/400x300/64748b/ffffff?text=Menos+de+$25k"
                                class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                                alt="[Imagen de autos económicos]">
                            <div class="absolute inset-0 bg-black/50 flex items-end p-4">
                                <h3 class="text-white text-xl font-bold">Menos de $25,000</h3>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Filtros y Resultados -->
            <div>
                <div class="bg-white p-4 rounded-xl shadow-md mb-8 sticky top-24 z-40">
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-center">
                        <div class="md:col-span-2 relative">
                            <input type="text" placeholder="Busca por marca o modelo..."
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                            <i data-lucide="search"
                                class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"></i>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Rango de Precio</label>
                            <div id="price-slider" class="price-slider-container">
                                <div class="price-slider-track"></div>
                                <div id="price-slider-range" class="price-slider-range"></div>
                                <div id="thumb-min" class="price-slider-thumb"></div>
                                <div id="thumb-max" class="price-slider-thumb"></div>
                            </div>
                            <div class="flex justify-between text-sm text-gray-600 mt-2">
                                <span id="min-price-display">$10,000</span>
                                <span id="max-price-display">$80,000+</span>
                            </div>
                        </div>
                        <button id="more-filters-btn"
                            class="w-full flex items-center justify-center p-3 bg-gray-100 text-gray-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors">
                            <i data-lucide="sliders-horizontal" class="w-5 h-5 mr-2"></i>
                            Más Filtros
                        </button>
                    </div>
                </div>

                <!-- Barra de resultados y ordenamiento -->
                <div class="flex justify-between items-center mb-6">
                    <p class="text-gray-600 font-medium">Mostrando <span class="font-bold text-gray-900">24</span> de
                        <span class="font-bold text-gray-900">78</span> vehículos
                    </p>
                    <div>
                        <label for="sort-by" class="sr-only">Ordenar por</label>
                        <select id="sort-by"
                            class="border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                            <option>Más Recientes</option>
                            <option>Precio: de menor a mayor</option>
                            <option>Precio: de mayor a menor</option>
                            <option>Kilometraje: de menor a mayor</option>
                        </select>
                    </div>
                </div>

                <!-- Grid de Vehículos -->
                <div id="vehicle-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Las tarjetas de vehículos se inyectarán aquí con JS para la animación -->
                </div>

                <!-- Paginación -->
                <div class="mt-12 flex justify-center">
                    <nav class="flex items-center space-x-2">
                        <a href="#" class="px-4 py-2 text-gray-500 bg-white rounded-lg hover:bg-gray-100"><i
                                data-lucide="chevron-left" class="w-5 h-5"></i></a>
                        <a href="#" class="px-4 py-2 text-white bg-blue-600 rounded-lg">1</a>
                        <a href="#" class="px-4 py-2 text-gray-700 bg-white rounded-lg hover:bg-gray-100">2</a>
                        <a href="#" class="px-4 py-2 text-gray-700 bg-white rounded-lg hover:bg-gray-100">3</a>
                        <span class="px-4 py-2 text-gray-500">...</span>
                        <a href="#" class="px-4 py-2 text-gray-700 bg-white rounded-lg hover:bg-gray-100">8</a>
                        <a href="#" class="px-4 py-2 text-gray-500 bg-white rounded-lg hover:bg-gray-100"><i
                                data-lucide="chevron-right" class="w-5 h-5"></i></a>
                    </nav>
                </div>
            </div>
        </main>

        <!-- Modal de Filtros Avanzados -->
        <div id="filters-modal" class="fixed inset-0 z-[100] hidden">
            <div id="filters-modal-backdrop" class="modal-backdrop absolute inset-0"></div>
            <div id="filters-modal-content"
                class="relative bg-white w-full max-w-md h-full ml-auto p-6 overflow-y-auto transform translate-x-full">
                <!-- El contenido se inyectará aquí -->
            </div>
        </div>

        <!-- Barra de Comparación -->
        <div id="compare-bar"
            class="fixed bottom-0 left-0 right-0 bg-gray-900 text-white p-4 z-50 transform translate-y-full transition-transform duration-300">
            <div class="container mx-auto flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <p class="font-bold">Comparar Vehículos (<span id="compare-count">0</span>/3)</p>
                    <div id="compare-preview" class="flex space-x-2"></div>
                </div>
                <div>
                    <button id="compare-now-btn"
                        class="bg-blue-600 font-semibold px-6 py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-500 disabled:cursor-not-allowed">Comparar</button>
                    <button id="clear-compare-btn" class="ml-2 text-gray-400 hover:text-white">Limpiar</button>
                </div>
            </div>
        </div>

        <!-- Modal de Comparación -->
        <div id="compare-modal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4">
            <div id="compare-modal-backdrop" class="modal-backdrop absolute inset-0"></div>
            <div id="compare-modal-content"
                class="bg-white rounded-2xl w-full max-w-5xl max-h-[90vh] flex flex-col overflow-hidden opacity-0 translate-y-4">
                <!-- El contenido se inyectará aquí -->
            </div>
        </div>

        <!-- Popover de Compartir -->
        <div id="share-popover" class="fixed z-[110] bg-white rounded-lg shadow-xl p-4 hidden">
            <p class="font-semibold text-sm mb-3">Compartir Vehículo</p>
            <div class="flex items-center space-x-4">
                <a href="#" class="share-link text-green-500 hover:text-green-600" data-platform="whatsapp"><i
                        data-lucide="message-circle" class="w-6 h-6"></i></a>
                <a href="#" class="share-link text-blue-800 hover:text-blue-900" data-platform="facebook"><i
                        data-lucide="facebook" class="w-6 h-6"></i></a>
                <button id="copy-link-btn" class="text-gray-600 hover:text-gray-900"><i data-lucide="link"
                        class="w-6 h-6"></i></button>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-gray-900 text-white mt-16">
            <!-- Contenido del footer -->
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DATA DE EJEMPLO ---
            const vehicleData = [
                { id: 1, name: 'Audi Q5 2.0 TFSI', year: 2022, mileage: 15000, transmission: 'Automática', price: 48500, image: 'https://placehold.co/600x400/334155/ffffff?text=Audi+Q5', engine: '2.0L Turbo', fuel: 'Gasolina' },
                { id: 2, name: 'BMW X3 xDrive30i', year: 2021, mileage: 22000, transmission: 'Automática', price: 52000, image: 'https://placehold.co/600x400/1e293b/ffffff?text=BMW+X3', engine: '2.0L TwinPower', fuel: 'Gasolina' },
                { id: 3, name: 'Porsche Macan S', year: 2020, mileage: 30000, transmission: 'Automática', price: 65000, image: 'https://placehold.co/600x400/0f172a/ffffff?text=Porsche+Macan', engine: '3.0L V6 Turbo', fuel: 'Gasolina' },
                { id: 4, name: 'Mercedes-Benz C200', year: 2022, mileage: 12000, transmission: 'Automática', price: 45000, image: 'https://placehold.co/600x400/4b5563/ffffff?text=MB+C200', engine: '1.5L Turbo', fuel: 'Híbrido Ligero' },
                { id: 5, name: 'Volvo XC60', year: 2021, mileage: 28000, transmission: 'Automática', price: 49000, image: 'https://placehold.co/600x400/52525b/ffffff?text=Volvo+XC60', engine: '2.0L Turbo', fuel: 'Gasolina' },
                { id: 6, name: 'Lexus NX 300h', year: 2020, mileage: 35000, transmission: 'Automática', price: 47500, image: 'https://placehold.co/600x400/64748b/ffffff?text=Lexus+NX', engine: '2.5L Híbrido', fuel: 'Híbrido' },
            ];

            const vehicleGrid = document.getElementById('vehicle-grid');

            function renderVehicleCards() {
                vehicleGrid.innerHTML = '';
                vehicleData.forEach(car => {
                    vehicleGrid.innerHTML += `
                    <div class="bg-white rounded-xl shadow-md overflow-hidden vehicle-card" data-id="${car.id}">
                        <div class="relative">
                            <img src="${car.image}" alt="[Imagen de un ${car.name}]" class="w-full h-56 object-cover">
                            <div class="absolute top-3 left-3 bg-blue-600 text-white text-xs font-bold px-2 py-1 rounded-full">Inspeccionado</div>
                            <div class="absolute top-3 right-3 flex space-x-2">
                                <button class="share-btn bg-white/70 backdrop-blur-sm rounded-full p-2 hover:bg-white" data-id="${car.id}">
                                    <i data-lucide="share-2" class="w-5 h-5 text-gray-700 share-icon"></i>
                                </button>
                                <button class="wishlist-btn bg-white/70 backdrop-blur-sm rounded-full p-2 hover:bg-white">
                                    <i data-lucide="heart" class="w-5 h-5 text-gray-700 heart-icon"></i>
                                </button>
                            </div>
                        </div>
                        <div class="p-6 flex flex-col h-full">
                            <h3 class="text-xl font-bold text-gray-900 truncate">${car.name}</h3>
                            <p class="text-gray-600 font-medium">${car.year} • ${car.mileage.toLocaleString()} km • ${car.transmission}</p>
                            <div class="mt-4">
                                <p class="text-2xl font-extrabold text-blue-600">$${car.price.toLocaleString()}</p>
                                <p class="text-sm text-gray-500">o desde <span class="font-semibold text-gray-700">$${Math.round(car.price / 60).toLocaleString()}/mes</span></p>
                            </div>
                            <div class="mt-4 flex items-center justify-between">
                                <label class="flex items-center space-x-2 text-sm font-medium text-gray-600 cursor-pointer">
                                    <input type="checkbox" class="compare-checkbox" data-id="${car.id}">
                                    <span>Comparar</span>
                                </label>
                                <a href="#" class="bg-gray-800 text-white text-center font-semibold py-2 px-4 rounded-lg hover:bg-gray-900 transition-colors text-sm">Ver Detalles</a>
                            </div>
                        </div>
                    </div>
                `;
                });
                lucide.createIcons();
                anime({
                    targets: '.vehicle-card',
                    opacity: [0, 1],
                    translateY: [20, 0],
                    delay: anime.stagger(100, { easing: 'easeOutQuad' }),
                    duration: 600,
                    easing: 'easeOutExpo'
                });
                addCardEventListeners();
            }

            // --- INICIALIZACIÓN ---
            lucide.createIcons();
            renderVehicleCards();

            // --- LÓGICA DE COMPARACIÓN (sin cambios) ---
            const compareBar = document.getElementById('compare-bar');
            const compareCount = document.getElementById('compare-count');
            const comparePreview = document.getElementById('compare-preview');
            const compareNowBtn = document.getElementById('compare-now-btn');
            const clearCompareBtn = document.getElementById('clear-compare-btn');
            const compareModal = document.getElementById('compare-modal');
            const compareModalContent = document.getElementById('compare-modal-content');
            const compareModalBackdrop = document.getElementById('compare-modal-backdrop');
            let compareList = [];
            function updateCompareBar() {
                compareCount.textContent = compareList.length;
                comparePreview.innerHTML = compareList.map(id => {
                    const car = vehicleData.find(c => c.id === id);
                    return `<img src="${car.image}" alt="${car.name}" class="w-12 h-8 object-cover rounded-md">`;
                }).join('');
                if (compareList.length > 0) { compareBar.style.transform = 'translateY(0)'; } else { compareBar.style.transform = 'translateY(100%)'; }
                compareNowBtn.disabled = compareList.length < 2;
            }
            function handleCompareChange(e) {
                const carId = parseInt(e.target.dataset.id);
                if (e.target.checked) {
                    if (compareList.length < 3) { compareList.push(carId); } else { e.target.checked = false; alert('Puedes comparar hasta 3 vehículos a la vez.'); }
                } else {
                    compareList = compareList.filter(id => id !== carId);
                }
                updateCompareBar();
            }
            function openCompareModal() {
                const carsToCompare = vehicleData.filter(car => compareList.includes(car.id));
                let modalHTML = `<div class="p-6 flex justify-between items-center border-b"><h2 class="text-2xl font-bold">Comparar Vehículos</h2><button id="close-compare-modal" class="text-gray-500 hover:text-gray-800"><i data-lucide="x" class="w-6 h-6"></i></button></div><div class="p-6 overflow-x-auto"><table class="w-full text-left"><thead><tr><th class="py-2">Característica</th>${carsToCompare.map(car => `<th class="py-2 text-center"><img src="${car.image}" class="w-32 h-20 object-cover rounded-lg mx-auto"><p class="font-bold mt-2">${car.name}</p></th>`).join('')}</tr></thead><tbody class="divide-y">${generateCompareRow('Precio', carsToCompare.map(c => `$${c.price.toLocaleString()}`))}
                            ${generateCompareRow('Año', carsToCompare.map(c => c.year))}
                            ${generateCompareRow('Kilometraje', carsToCompare.map(c => `${c.mileage.toLocaleString()} km`))}
                            ${generateCompareRow('Motor', carsToCompare.map(c => c.engine))}
                            ${generateCompareRow('Transmisión', carsToCompare.map(c => c.transmission))}
                            ${generateCompareRow('Combustible', carsToCompare.map(c => c.fuel))}</tbody></table></div>`;
                compareModalContent.innerHTML = modalHTML;
                lucide.createIcons();
                compareModal.classList.remove('hidden');
                compareModal.classList.add('flex');
                anime({ targets: compareModalContent, opacity: [0, 1], translateY: [16, 0], duration: 400, easing: 'easeOutCubic' });
                document.getElementById('close-compare-modal').addEventListener('click', closeCompareModal);
            }
            function generateCompareRow(label, values) { return `<tr><td class="py-3 font-semibold text-gray-600">${label}</td>${values.map(val => `<td class="py-3 text-center">${val}</td>`).join('')}</tr>`; }
            function closeCompareModal() { anime({ targets: compareModalContent, opacity: 0, translateY: 16, duration: 300, easing: 'easeInCubic', complete: () => { compareModal.classList.add('hidden'); compareModal.classList.remove('flex'); } }); }
            clearCompareBtn.addEventListener('click', () => { compareList = []; document.querySelectorAll('.compare-checkbox').forEach(cb => cb.checked = false); updateCompareBar(); });
            compareNowBtn.addEventListener('click', openCompareModal);
            compareModalBackdrop.addEventListener('click', closeCompareModal);

            // --- LÓGICA DE WISHLIST, COMPARTIR Y EVENTOS DE TARJETA ---
            const sharePopover = document.getElementById('share-popover');

            function openSharePopover(event) {
                const btn = event.currentTarget;
                const rect = btn.getBoundingClientRect();
                sharePopover.classList.remove('hidden');

                // Posicionar el popover
                sharePopover.style.top = `${rect.bottom + window.scrollY + 8}px`;
                sharePopover.style.left = `${rect.right + window.scrollX - sharePopover.offsetWidth}px`;

                anime({ targets: sharePopover, scale: [0.8, 1], opacity: [0, 1], duration: 200, easing: 'easeOutQuad' });

                // Cerrar al hacer clic afuera
                setTimeout(() => {
                    document.body.addEventListener('click', closeSharePopoverOnClickOutside, { once: true });
                }, 0);
            }

            function closeSharePopover() {
                anime({
                    targets: sharePopover,
                    scale: [1, 0.8],
                    opacity: [1, 0],
                    duration: 200,
                    easing: 'easeInQuad',
                    complete: () => sharePopover.classList.add('hidden')
                });
            }

            function closeSharePopoverOnClickOutside(event) {
                if (!sharePopover.contains(event.target) && !event.target.closest('.share-btn')) {
                    closeSharePopover();
                } else {
                    document.body.addEventListener('click', closeSharePopoverOnClickOutside, { once: true });
                }
            }

            function addCardEventListeners() {
                document.querySelectorAll('.wishlist-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => { e.currentTarget.querySelector('.heart-icon').classList.toggle('filled'); });
                });
                document.querySelectorAll('.compare-checkbox').forEach(cb => {
                    cb.addEventListener('change', handleCompareChange);
                });
                document.querySelectorAll('.share-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation(); // Evitar que el clic en el body cierre inmediatamente
                        openSharePopover(e);
                    });
                });
            }

            document.getElementById('copy-link-btn')?.addEventListener('click', () => {
                navigator.clipboard.writeText(window.location.href).then(() => alert('Enlace copiado!'));
                closeSharePopover();
            });

            // --- LÓGICA DE FILTROS ---
            const moreFiltersBtn = document.getElementById('more-filters-btn');
            const filtersModal = document.getElementById('filters-modal');
            const filtersModalContent = document.getElementById('filters-modal-content');
            const filtersModalBackdrop = document.getElementById('filters-modal-backdrop');

            function openFiltersModal() {
                filtersModalContent.innerHTML = `
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold">Todos los Filtros</h3>
                    <button id="close-modal-btn" class="text-gray-500 hover:text-gray-800"><i data-lucide="x" class="w-6 h-6"></i></button>
                </div>
                <div class="space-y-6">
                    <div class="filter-category"><h4 class="font-semibold mb-3">Carrocería</h4><div class="grid grid-cols-2 gap-3"><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>SUV</span></label><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Sedán</span></label><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Hatchback</span></label><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Coupé</span></label></div></div>
                    <div class="filter-category"><h4 class="font-semibold mb-3">Transmisión</h4><div class="grid grid-cols-2 gap-3"><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Automática</span></label><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Mecánica</span></label></div></div>
                    <div class="filter-category"><h4 class="font-semibold mb-3">Combustible</h4><div class="grid grid-cols-2 gap-3"><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Gasolina</span></label><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Diésel</span></label><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Híbrido</span></label></div></div>
                    <div class="filter-category"><h4 class="font-semibold mb-3">Características</h4><div class="grid grid-cols-2 gap-3"><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Sunroof</span></label><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Asientos de Cuero</span></label><label class="flex items-center space-x-2"><input type="checkbox" class="rounded text-blue-600"><span>Apple CarPlay</span></label></div></div>
                </div>
                <div class="mt-8 pt-6 border-t border-gray-200 flex space-x-4">
                    <button class="w-1/2 bg-gray-200 text-gray-800 font-semibold py-3 rounded-lg">Limpiar</button>
                    <button id="apply-filters-btn" class="w-1/2 bg-blue-600 text-white font-semibold py-3 rounded-lg">Aplicar Filtros</button>
                </div>
            `;
                lucide.createIcons();
                filtersModal.classList.remove('hidden');
                anime({ targets: filtersModalContent, translateX: ['100%', '0%'], duration: 400, easing: 'easeOutCubic' });
                anime({
                    targets: '.filter-category',
                    opacity: [0, 1],
                    translateY: [15, 0],
                    delay: anime.stagger(100, { start: 200 }),
                    easing: 'easeOutExpo'
                });
                document.getElementById('close-modal-btn').addEventListener('click', closeFiltersModal);
                document.getElementById('apply-filters-btn').addEventListener('click', closeFiltersModal);
            }

            function closeFiltersModal() {
                anime({
                    targets: filtersModalContent,
                    translateX: ['0%', '100%'],
                    duration: 400,
                    easing: 'easeInCubic',
                    complete: () => filtersModal.classList.add('hidden')
                });
            }

            moreFiltersBtn.addEventListener('click', openFiltersModal);
            filtersModalBackdrop.addEventListener('click', closeFiltersModal);

            // --- Price Slider Logic (simplificado) ---
            const slider = document.getElementById('price-slider');
            const thumbMin = document.getElementById('thumb-min');
            const thumbMax = document.getElementById('thumb-max');
            const range = document.getElementById('price-slider-range');
            const minDisplay = document.getElementById('min-price-display');
            const maxDisplay = document.getElementById('max-price-display');
            const minPrice = 10000;
            const maxPrice = 100000;
            function updateSliderView(minVal, maxVal) {
                const minPercent = ((minVal - minPrice) / (maxPrice - minPrice)) * 100;
                const maxPercent = ((maxVal - minPrice) / (maxPrice - minPrice)) * 100;
                thumbMin.style.left = `${minPercent}%`;
                thumbMax.style.left = `${maxPercent}%`;
                range.style.left = `${minPercent}%`;
                range.style.width = `${maxPercent - minPercent}%`;
                minDisplay.textContent = `$${minVal.toLocaleString()}`;
                maxDisplay.textContent = maxVal >= maxPrice ? `$${maxVal.toLocaleString()}+` : `$${maxVal.toLocaleString()}`;
            }
            updateSliderView(10000, 100000);
        });
    </script>
</body>

</html>